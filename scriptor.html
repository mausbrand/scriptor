<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Script0r</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/lib/codemirror.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/addon/fold/foldgutter.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/addon/hint/show-hint.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/addon/lint/lint.css">

    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/lib/codemirror.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/addon/comment/comment.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/addon/display/autorefresh.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/addon/selection/active-line.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/keymap/sublime.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/addon/hint/show-hint.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/addon/lint/lint.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/mode/python/python.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/addon/fold/foldcode.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/addon/fold/foldgutter.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/addon/fold/brace-fold.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/addon/fold/indent-fold.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/addon/fold/comment-fold.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/addon/edit/closebrackets.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.8/addon/edit/matchbrackets.js"></script>

    <link rel="stylesheet" href="css/neo.css">
    <link rel="stylesheet" href="css/scriptor.css">

    <script src="scriptor.js"></script>
</head>
<body>
    <main class="main">
        <header class="header">
            <div class="header-left">
                <h1 id="host">Script0rÂ²</h1>
                <div class="header-note">
                    Warning: Does currently (and unfortunately) only work in Chromium.</div>
            </div>
            <div class="header-right">
                <button id="run" class="btn header-btn btn-run">
                    <img src="icon/run.svg" class="icon">
                    <span>Run</span>
                </button>
                <button id="clear" class="btn header-btn btn-clear">
                    <img src="icon/clear.svg" class="icon">
                    <span>Clear</span>
                </button>
                <button id="stop" disabled  class="btn header-btn btn-abort">
                    <img src="icon/abort.svg" class="icon">
                    <span>Abort</span>
                </button>
            </div>
        </header>

        <div class="content">
            <div class="code">
                <textarea id="code">
                    # Debugging
                    logging.debug("Debug")
                    logging.info("Info")
                    logging.warning("Warning")
                    logging.error("Error")

                    # Get current user
                    if not (user := viur.view("/user/view/self")):
                        logging.error("You are not logged in")
                        exit()

                    logging.debug("Hello " + user["name"])

                    # Get list of all users
                    for i, user in enumerate(viur.list("/user/list")):
                        logging.debug(f"""{i}: {user["name"]}""")

                    # Export a CSV file with specific fields from the user module
                    csv = csvwriter("key", "name", "access")
                    for user in viur.list("/user/list"):
                        csv.write(user)

                    csv.download("users.csv")
                </textarea>
            </div>

            <div class="output">
                <ul id="output"></ul>
            </div>

        </div>
    </main>

</body>
</html>
